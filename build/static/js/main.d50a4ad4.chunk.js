(this["webpackJsonpgreencom-front"]=this["webpackJsonpgreencom-front"]||[]).push([[0],{149:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n.n(o),c=n(19),r=n.n(c),i=(n(76),n(25)),s=n(26),d=n(30),l=n(29),u=n(2),j=n(66),b=n(67),p=n(5),h=n(36),O=n(4),m=n.n(O),f=n(8),v=n(68),x=n.n(v),g="https://greencom-api.azurewebsites.net";function w(e,t){var n=Object(o.useState)((function(){return function(e,t){return JSON.parse(localStorage.getItem(e))||t}(e,t)})),a=Object(u.a)(n,2),c=a[0],r=a[1];return Object(o.useEffect)((function(){localStorage.setItem(e,JSON.stringify(c))}),[c]),[c,r]}function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=Object(o.useState)([]),c=Object(u.a)(a,2),r=c[0],i=c[1],s=w("token",null),d=Object(u.a)(s,2),l=d[0];d[1];return Object(o.useEffect)((function(){if(""!==t){var n={produto:e,periodo:t};m()({method:"GET",headers:{Authorization:"Token "+l},url:"https://greencom-api.azurewebsites.net/periodos",params:n}).then((function(e){i(e.data.dados)}))}}),[e,t,n]),{dadosPeriodo:r}}var k=n(0),_=function(){var e=Object(o.useRef)(null),t=w("username",null),n=Object(u.a)(t,1)[0],a=w("isRep",null),c=[{label:"Conta",icon:"pi pi-user",url:"/conta"},{label:"Pedidos",icon:"pi pi-upload",url:"/pedidos"}];Object(u.a)(a,1)[0]&&(c.push({label:"Promocoes",icon:"pi pi-external-link",url:"/promocoes"}),c.push({label:"Clientes",icon:"pi pi-external-link",url:"/clientes"}));var r=[{label:n,items:c}];return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(b.Menu,{model:r,popup:!0,ref:e,id:"popup_menu"}),Object(k.jsx)(p.Button,{icon:"pi pi-user",onClick:function(t){return e.current.toggle(t)},"aria-controls":"popup_menu","aria-haspopup":!0})]})},N=function(e){Object(d.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).handleSearch=function(e){""!==o.state.query&&(e.preventDefault(),window.location="/busca?query="+o.state.query,o.setState({query:""}))},o.handleChangeSearch=function(e){o.setState({query:e.target.value}),e.target.value.length>=13&&/^\d+$/.test(e.target.value)&&(e.preventDefault(),console.log(o.state.query),window.location="/busca?query="+e.target.value,o.setState({query:""}))},o.state={items:[],query:"",lastUpdate:1623533795696,displayModal:!0},o}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.updateCats()}},{key:"updateCats",value:function(){var e=this,t=Date.now();if(t-this.state.lastUpdate>9e5){this.setState({lastUpdate:t});m()({method:"GET",url:"https://greencom-api.azurewebsites.net/categorias",headers:{Authorization:"Token "+localStorage.getItem("token")}}).then((function(t){e.setState({items:t.data})}))}}},{key:"render",value:function(){var e=this.state.items,t=Object(k.jsx)("a",{href:"/",children:Object(k.jsx)("img",{alt:"logo",src:"https://ondasstr092020.blob.core.windows.net/modelo/logo.png",height:"40",className:"p-mr-2"})}),n=Object(k.jsx)("a",{href:"/login",children:"Login"});return this.props.loggedIn&&(n=Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(h.InputText,{onChange:this.handleChangeSearch,placeholder:"Buscar",type:"text"}),Object(k.jsx)(p.Button,{onClick:this.handleSearch,icon:"pi pi-search",className:"p-button-rounded p-button-secondary"}),Object(k.jsx)(p.Button,{icon:"pi pi-shopping-cart",onClick:function(e){return window.location.href="/carrinho"},"aria-controls":"popup_menu","aria-haspopup":!0}),Object(k.jsx)(_,{})]})),Object(k.jsx)("div",{children:Object(k.jsx)("div",{className:"card",children:Object(k.jsx)(j.Menubar,{model:e,start:t,end:n})})})}}]),n}(a.a.Component),y=function(e){Object(d.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).state={banners:[]},o}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.updateBanners(),document.title="Greenish B2B"}},{key:"updateBanners",value:function(){var e=this;m()({method:"GET",url:"https://greencom-api.azurewebsites.net/home"}).then((function(t){e.setState({banners:t.data.banners}),console.log(e.state.banners)}))}},{key:"render",value:function(){var e=this.state.banners.slice().map((function(e,t){return Object(k.jsx)("a",{href:e.url,children:Object(k.jsx)("img",{src:e.img})})}));return Object(k.jsx)("div",{children:e})}}]),n}(a.a.Component),C=n(31),B=(n(43),n(17));function I(e){var t=Object(o.useState)(""),n=Object(u.a)(t,2),a=n[0],c=n[1],r=Object(o.useState)(""),i=Object(u.a)(r,2),s=i[0],d=i[1],l=w("token",null),j=Object(u.a)(l,2),b=(j[0],j[1]),O=w("loggedin",null),f=Object(u.a)(O,2)[1],v=w("clienteId",null),x=Object(u.a)(v,2)[1],S=w("clienteNome",null),_=Object(u.a)(S,2)[1],N=w("isRep",null),y=Object(u.a)(N,2),I=(y[0],y[1]),T=w("username",null),A=Object(u.a)(T,2)[1],q=w("carrinhoId",null),E=Object(u.a)(q,2)[1],P=Object(o.useRef)(null);Object(o.useEffect)((function(){document.title="Greenish B2B | Login"}),[]);return Object(k.jsxs)("div",{children:[Object(k.jsx)(B.Messages,{ref:P}),Object(k.jsxs)("div",{className:"p-field",children:[Object(k.jsx)("label",{htmlFor:"login",children:"Login"}),Object(k.jsx)(h.InputText,{id:"login",value:a,onChange:function(e){return c(e.target.value)}})]}),Object(k.jsxs)("div",{className:"p-field",children:[Object(k.jsx)("label",{htmlFor:"senha",children:"Senha"}),Object(k.jsx)(C.Password,{id:"senha",value:s,onChange:function(e){return d(e.target.value)},feedback:!1})]}),Object(k.jsx)(p.Button,{label:"Entrar",onClick:function(){return function(){var e=new FormData;e.append("username",a),e.append("password",s),m.a.post(g+"/api-token-auth/",e).then((function(e){var t={headers:{Authorization:"Token "+e.data.token}};b(e.data.token),m.a.get(g+"/login",t).then((function(e){f(!0),x(e.data.clienteId),_(e.data.clienteNome),I(e.data.isRep),A(e.data.username),E(null),window.location.href="/"}))})).catch((function(e){P.current.show([{severity:"error",summary:"Usuario ou senha Incorretos",sticky:!1}]),c(""),d("")}))}()}})]})}var T=n(27);function A(e){var t=Object(o.useState)([]),n=Object(u.a)(t,2),a=n[0],c=n[1],r=w("token",null),i=Object(u.a)(r,2),s=i[0],d=(i[1],w("clienteId",null)),l=Object(u.a)(d,2)[1],j=w("clienteNome",null),b=Object(u.a)(j,2)[1],h=w("carrinhoId",null),O=Object(u.a)(h,2),f=O[0],v=O[1];Object(o.useEffect)((function(){S(),document.title="Greenish B2B | Clientes"}),[]);var x=function(e,t){m()({method:"GET",headers:{Authorization:"Token "+s},url:g+"/pedidos/deleta/"+f}),l(e),b(t),v(null),window.location.href="/"},S=function(){m()({method:"GET",headers:{Authorization:"Token "+s},url:"https://greencom-api.azurewebsites.net/clientes"}).then((function(e){c(e.data.clientes)}))},_=a.slice().map((function(e,t){return Object(k.jsxs)("div",{children:[Object(k.jsx)("p",{children:e.nome+" - "+e.tabela_precos}),Object(k.jsx)(p.Button,{label:"Selecionar",onClick:function(){return t=e.id,n=e.nome,void Object(T.confirmDialog)({message:"Itens nao salvos no carrinho serao apagados. Confirma alteracao?",header:"Confirmacao",icon:"pi pi-exclamation-triangle",acceptLabel:"Sim",rejectLabel:"Nao",accept:function(){return x(t,n)}});var t,n}})]})}));return Object(k.jsx)("div",{children:_})}var q=n(70),E=n(14);function P(e){var t=Object(o.useState)([]),n=Object(u.a)(t,2),a=n[0],c=n[1],r=w("carrinhoId",null),i=Object(u.a)(r,2),s=i[0],d=i[1],l=w("clienteId",null),j=Object(u.a)(l,2)[1],b=w("clienteNome",null),h=Object(u.a)(b,2)[1],O=w("isRep",null),f=Object(u.a)(O,1)[0],v=w("token",null),x=Object(u.a)(v,2),S=x[0],_=(x[1],Object(o.useState)(!1)),N=Object(u.a)(_,2),y=N[0],C=N[1],I=Object(o.useRef)(null);Object(o.useEffect)((function(){P(),document.title="Greenish B2B | Pedidos"}),[]);var A=function(e,t,n){m()({method:"GET",url:g+"/pedidos/retoma/"+e,headers:{Authorization:"Token "+S},params:{carrinhoAtualId:s}}).then((function(o){o.data.confirmed?(d(e),j(t),h(n),window.location.href="/carrinho"):I.current.show([{severity:"error",summary:o.data.message,sticky:!1}])}))},P=function(){m()({method:"GET",url:"https://greencom-api.azurewebsites.net/pedidos",headers:{Authorization:"Token "+S}}).then((function(e){console.log(e.data),c(e.data.pedidos)}))},z=a.slice().map((function(e,t){return Object(k.jsxs)("div",{children:[Object(k.jsx)("p",{children:e.id+" - "+e.user__name+" - "+e.cliente__nome+" - "+e.qtd_total+" - "+e.valor_total+" - "+e.liberado_cliente+" - "+e.liberado_rep+" - "+e.enviado_fabrica}),e.liberado_rep?Object(k.jsx)(k.Fragment,{}):Object(k.jsx)(p.Button,{label:"Alterar",onClick:function(){return t=e.id,n=e.cliente__id,o=e.cliente__nome,void Object(T.confirmDialog)({message:"Itens nao salvos no carrinho serao apagados. Confirma alteracao?",header:"Confirmacao",icon:"pi pi-exclamation-triangle",acceptLabel:"Sim",rejectLabel:"Nao",accept:function(){return A(t,n,o)}});var t,n,o}}),e.liberado_rep?Object(k.jsx)(k.Fragment,{}):e.liberado_cliente&&f?Object(k.jsx)(p.Button,{label:"Processar",onClick:function(){return t=e.id,C(!0),void m()({method:"GET",url:g+"/pedidos/processa/"+t,headers:{Authorization:"Token "+S}}).then((function(e){C(!1),e.data.confirmed?(console.log(e.data),P()):I.current.show([{severity:"error",summary:e.data.message,sticky:!0}])}));var t}}):Object(k.jsx)(k.Fragment,{})]})}));return Object(k.jsxs)("div",{children:[Object(k.jsx)(B.Messages,{ref:I}),Object(k.jsx)(E.Dialog,{title:"Processando",visible:y,onHide:function(){return""},children:Object(k.jsx)(q.ProgressSpinner,{})}),z]})}function z(e){var t=Object(o.useState)([]),n=Object(u.a)(t,2),a=n[0],c=n[1],r=w("carrinhoId",null),i=Object(u.a)(r,2),s=i[0],d=(i[1],w("token",null)),l=Object(u.a)(d,2),j=l[0];l[1];Object(o.useEffect)((function(){b(),document.title="Greenish B2B | Promocoes"}),[]);var b=function(){m()({method:"GET",headers:{Authorization:"Token "+j},url:"https://greencom-api.azurewebsites.net/promocoes"}).then((function(e){c(e.data.promocoes),console.log(e.data.promocoes)}))},h=a.slice(),O=[],f=function(){var e=v,t=h[e].condicoes.map((function(t,n){return Object(k.jsx)("div",{children:Object(k.jsx)(p.Button,{label:t.condicao,onClick:function(){return function(e,t){var n=g+"/promocoes/"+s;m()({method:"GET",url:n,headers:{Authorization:"Token "+j},params:{id_promocao:e,id_condicao:t}}).then((function(e){console.log(e.data.message)}))}(h[e].id_promocao,t.id)}})})}));O.push(Object(k.jsxs)("div",{children:[Object(k.jsx)("p",{children:h[e].descricao}),t]}))};for(var v in h)f();O.push(Object(k.jsxs)("div",{children:[Object(k.jsx)("p",{children:"Remover"}),Object(k.jsx)(p.Button,{label:"Remover",onClick:function(){return function(){var e=g+"/promocoes/remove/"+s;m()({method:"GET",headers:{Authorization:"Token "+j},url:e}).then((function(e){console.log(e.data.message)}))}()}})]}));var x=O.map((function(e){return e}));return Object(k.jsx)("div",{children:x})}n(34);function G(e){var t=Object(o.useState)(""),n=Object(u.a)(t,2),a=n[0],c=n[1],r=Object(o.useState)(""),i=Object(u.a)(r,2),s=i[0],d=i[1],l=Object(o.useState)(""),j=Object(u.a)(l,2),b=j[0],h=j[1],O=w("token",null),f=Object(u.a)(O,2),v=f[0],x=(f[1],Object(o.useState)(!1)),S=Object(u.a)(x,2),_=S[0],N=S[1],y=Object(o.useRef)(null);Object(o.useEffect)((function(){document.title="Greenish B2B | Conta"}),[]);return Object(k.jsxs)("div",{children:[Object(k.jsxs)(E.Dialog,{title:"Alterar Senha",visible:_,onHide:function(){return N(!1)},children:[Object(k.jsx)(B.Messages,{ref:y}),Object(k.jsx)("h5",{children:"Senha Atual"}),Object(k.jsx)(C.Password,{value:a,onChange:function(e){return c(e.target.value)},feedback:!1}),Object(k.jsx)("h5",{children:"Senha Nova"}),Object(k.jsx)(C.Password,{value:s,onChange:function(e){return d(e.target.value)},feedback:!1}),Object(k.jsx)("h5",{children:"Confirme a Nova Senha"}),Object(k.jsx)(C.Password,{value:b,onChange:function(e){return h(e.target.value)},feedback:!1}),Object(k.jsx)("h5",{}),Object(k.jsx)(p.Button,{label:"Confirmar",onClick:function(){return function(){if(s===b){var e={senhaNova:s,senhaAtual:a},t={headers:{Authorization:"Token "+v}};m.a.post(g+"/change_password/",e,t).then((function(e){e.data.confirmed?(localStorage.clear(),window.location.href="/login"):y.current.show([{severity:"error",summary:e.data.message,sticky:!1}])}))}else y.current.show([{severity:"error",summary:"Confirmacao de nova senha invalida",sticky:!1}]);c(""),d(""),h("")}()}})]}),Object(k.jsx)(p.Button,{label:"Alterar Senha",onClick:function(){return N(!0)}}),Object(k.jsx)(p.Button,{label:"Logout",onClick:function(){return function(){var e={headers:{Authorization:"Token "+v}};m.a.get(g+"/accounts/logout",e).then((function(e){localStorage.clear(),window.location.href="/"}))}()}})]})}var D=n(32),R=n(28),F=n(18);function L(e){var t=Object(o.useState)(!1),n=Object(u.a)(t,2),a=n[0],c=n[1],r=Object(k.jsxs)("div",{children:[Object(k.jsx)("h3",{children:e.produto.produto__descricao}),Object(k.jsx)("p",{children:e.produto.produto__produto+" - "+e.produto.produto__linha+" - R$"+e.produto.preco})]});return Object(k.jsx)("div",{className:"p-shadow-2 p-m-2",children:Object(k.jsxs)(R.Card,{header:r,children:[Object(k.jsx)("img",{top:!0,width:"100%",src:e.produto.produto__url_imagem,alt:"Sem Imagem"}),Object(k.jsx)("div",{className:"p-grid",children:Object(k.jsxs)("div",{className:"p-field p-col-12 p-md-3",children:[Object(k.jsx)(p.Button,{label:"Detalhes",icon:"pi pi-external-link",onClick:function(){c(!0)}}),Object(k.jsx)(E.Dialog,{header:e.produto.produto__produto,maximizable:!0,visible:a,style:{width:"75vw"},onHide:function(){c(!1)},children:Object(k.jsxs)("div",{className:"p-grid",children:[Object(k.jsx)("div",{className:"p-col",children:Object(k.jsx)("img",{top:!0,width:"100%",src:e.produto.produto__url_imagem,alt:"Sem Imagem"})}),Object(k.jsx)("div",{className:"p-col-fixed",style:{width:"500px"},children:Object(k.jsx)(M,{produto:e.produto})})]})})]})})]})})}function M(e){var t=Object(o.useState)(e.produto),n=Object(u.a)(t,1)[0],a=Object(o.useState)(""),c=Object(u.a)(a,2),r=c[0],i=c[1],s=Object(o.useState)({}),d=Object(u.a)(s,2),l=d[0],j=d[1],b=Object(o.useState)(Object(k.jsx)("div",{})),h=Object(u.a)(b,2),O=h[0],f=h[1],v=w("token",null),x=Object(u.a)(v,2),_=x[0],N=(x[1],w("clienteId",null)),y=Object(u.a)(N,1)[0],C=w("carrinhoId",null),I=Object(u.a)(C,2),T=I[0],A=I[1],q=Object(o.useRef)(null),E=S(n.produto__produto,r).dadosPeriodo;Object(o.useEffect)((function(){var e={};for(var t in E){var o=E[t].cor,a=new Array(n.produto__qtd_tamanhos).fill(0);e[o]=a}j(e)}),[E]),Object(o.useEffect)((function(){if(""!==r){var e=E.map((function(e){return Object(k.jsx)(U,{dados:e,pedido:l,setPedido:j})}));f(e)}}),[l]);return Object(k.jsxs)("div",{children:[Object(k.jsx)(B.Messages,{ref:q}),Object(k.jsx)(F.Dropdown,{id:"dropdown",value:r,options:JSON.parse(e.produto.produto__periodos),onChange:function(e){return i(e.value)}}),Object(k.jsxs)("div",{className:"p-grid",children:[Object(k.jsx)("div",{className:"p-col",children:"TIPO"}),Object(k.jsx)("div",{className:"p-col",children:"COR"}),function(e){return JSON.parse(e.produto.produto__tamanhos).map((function(e){return Object(k.jsx)("div",{className:"p-col-1",children:e})}))}(e)]}),O,Object(k.jsx)(p.Button,{label:"Adicionar",onClick:function(){var e=0;for(var t in l){e+=l[t].reduce((function(e,t){return e+t}),0)}var o={produto:n,periodo:r,qtds:l,qtd_total:e,clienteId:y,carrinhoId:T},a={headers:{Authorization:"Token "+_}};console.log(o),console.log(a.headers),m.a.post(g+"/carrinho/",o,a).then((function(e){e.data.confirmed?(q.current.show([{severity:"success",summary:e.data.message,sticky:!0}]),A(e.data.carrinhoId)):q.current.show([{severity:"error",summary:e.data.message,sticky:!0}])})).catch((function(e){console.log(e.message)}))}})]})}function U(e){var t=function(e,t,n){var o=t.pedido;o[t.dados.cor][n]=e,t.setPedido(o)};return Object(k.jsxs)("div",{className:"p-grid",children:[Object(k.jsx)("div",{className:"p-col",children:e.dados.desc_liberacao}),Object(k.jsx)("div",{className:"p-col",children:e.dados.cor+" - "+e.dados.desc_cor}),function(e){var n=[];if(0===Object.keys(e.pedido).length)return n.map((function(e){return e}));var o=function(){var o=a;e.dados.liberacao?n.push(Object(k.jsx)("div",{className:"p-col-1 p-mt-4",children:Object(k.jsx)(D.InputNumber,{min:0,id:e.dados.cor+o,value:e.pedido[e.dados.cor][o],onValueChange:function(n){return t(n.value,e,o)},mode:"decimal",showButtons:!0,buttonLayout:"vertical",style:{width:"2.5em"},decrementButtonClassName:"p-button-secondary",incrementButtonClassName:"p-button-secondary",incrementButtonIcon:"pi pi-plus",decrementButtonIcon:"pi pi-minus"})})):(console.log(e.dados.qtds),n.push(Object(k.jsx)("div",{className:"p-col-1 p-mt-4",children:Object(k.jsxs)("span",{className:"p-float-label",children:[Object(k.jsx)(D.InputNumber,{max:e.dados.qtds[o],min:0,id:e.dados.cor+o,value:e.pedido[e.dados.cor][o],onValueChange:function(n){return t(n.value,e,o)},mode:"decimal",showButtons:!0,buttonLayout:"vertical",style:{width:"2.5em"},decrementButtonClassName:"p-button-secondary",incrementButtonClassName:"p-button-secondary",incrementButtonIcon:"pi pi-plus",decrementButtonIcon:"pi pi-minus"}),Object(k.jsx)("label",{htmlFor:e.dados.cor+o,children:e.dados.qtds[o]})]})})))};for(var a in e.dados.qtds)o();return n.map((function(e){return e}))}(e)]})}var J=n(37);function H(){var e=Object(o.useState)(Object(k.jsx)("div",{})),t=Object(u.a)(e,2),n=t[0],a=t[1],c=Object(o.useState)(0),r=Object(u.a)(c,2),i=r[0],s=r[1],d=Object(o.useState)(12),l=Object(u.a)(d,2),j=l[0],b=l[1],h=Object(o.useState)(0),O=Object(u.a)(h,2),v=O[0],S=O[1],_=w("token",null),N=Object(u.a)(_,2),y=N[0],C=(N[1],w("colecao","Todas")),B=Object(u.a)(C,2),I=B[0],T=B[1],A=w("periodo",null),q=Object(u.a)(A,2),P=q[0],z=q[1],G=w("clienteId",null),D=Object(u.a)(G,1)[0],R=w("tamColuna",2),M=Object(u.a)(R,2),U=M[0],H=M[1],V=Object(o.useState)("p-col-12 p-md-6 p-lg-"+U),$=Object(u.a)(V,2),Q=$[0],K=$[1],W=Object(o.useState)(!1),X=Object(u.a)(W,2),Y=X[0],Z=X[1],ee=Object(o.useState)([]),te=Object(u.a)(ee,2),ne=te[0],oe=te[1],ae=Object(o.useState)([]),ce=Object(u.a)(ae,2),re=ce[0],ie=ce[1];Object(o.useEffect)((function(){m()({method:"GET",headers:{Authorization:"Token "+y},url:"https://greencom-api.azurewebsites.net/filterOptions"}).then((function(e){console.log(e.data);var t=e.data.colecoes;t.push("Todas"),oe(t),ie(e.data.periodos)})),document.title="Greenish B2B | Produtos"}),[]);var se=function(e,t,n){var a=Object(o.useState)({}),c=Object(u.a)(a,2),r=c[0],i=c[1],s=Object(f.g)(),d=w("token",null),l=Object(u.a)(d,2),j=l[0];return l[1],Object(o.useEffect)((function(){var o=x.a.parse(window.location.search),a=g+s.pathname+"/",c=e;"Todas"===c&&(c=null),m()({method:"GET",url:a,headers:{Authorization:"Token "+j},params:{query:o.query,colecao:c,periodo:t,clienteId:n}}).then((function(e){i(e.data)}))}),[s,e,t,n]),{produtos:r}}(I,P,D).produtos;return Object(o.useEffect)((function(){if("lista"in se){S(se.lista.length);var e,t=se.lista.slice(i,i+j);e=t.map((function(e,t){return Object(k.jsx)("div",{className:Q,children:Object(k.jsx)(L,{produto:e},t)})})),a(e),window.scrollTo(0,0)}}),[se,Q,i,j]),Object(o.useEffect)((function(){K("p-col-12 p-md-6 p-lg-"+U)}),[U]),Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)("div",{children:[Object(k.jsx)(p.Button,{label:"Filtrar",onClick:function(){Z(!0)},className:"p-mr-2"}),Object(k.jsx)(E.Dialog,{header:"Filtros",visible:Y,style:{width:"75vw"},onHide:function(){Z(!1)},children:Object(k.jsxs)("div",{className:"p-grid",children:[Object(k.jsxs)("div",{className:"p-col-12 p-md-6 p-lg-2",children:[Object(k.jsx)("h3",{children:"Colecao"}),Object(k.jsx)(F.Dropdown,{id:"dropdown",value:I,options:ne,onChange:function(e){return T(e.value)}})]}),Object(k.jsxs)("div",{className:"p-col-12 p-md-6 p-lg-2",children:[Object(k.jsx)("h3",{children:"Periodo"}),Object(k.jsx)(F.Dropdown,{id:"dropdown",value:P,options:re,onChange:function(e){return z(e.value)}})]}),Object(k.jsxs)("div",{className:"p-col-12 p-md-6 p-lg-2",children:[Object(k.jsx)("h3",{children:"Coluna"}),Object(k.jsx)(F.Dropdown,{id:"dropdown",value:U,options:[2,3,4],onChange:function(e){return H(e.value)}})]})]})})]}),Object(k.jsx)("div",{className:"p-grid",children:n}),Object(k.jsx)(J.Paginator,{first:i,rows:j,totalRecords:v,rowsPerPageOptions:[12,24,36],onPageChange:function(e){s(e.first),b(e.rows)}})]})}function V(e){var t=Object(o.useState)(!1),n=Object(u.a)(t,2),a=n[0],c=n[1],r=w("token",null),i=Object(u.a)(r,2),s=i[0],d=(i[1],function(){c(!1)}),l=function(){m()({method:"GET",url:g+"/carrinho/delete_item/"+e.produto.id,headers:{Authorization:"Token "+s}}).then((function(t){e.forceUpdate()}))},j=e.produto.preco-e.produto.desconto,b=e.produto.preco,h=Object(k.jsxs)("div",{children:[Object(k.jsx)("h3",{children:e.produto.produto__descricao}),Object(k.jsx)("p",{children:e.produto.produto__produto+" - "+e.produto.qtd_item+" - R$"+e.produto.valor_item}),e.produto.desconto>0?Object(k.jsx)("p",{children:"Pre\xe7o: De R$"+b+" por R$"+j}):Object(k.jsx)("p",{children:"Pre\xe7o: R$"+e.produto.preco})]});return Object(k.jsx)("div",{className:"p-shadow-2 p-m-2",children:Object(k.jsxs)(R.Card,{header:h,children:[Object(k.jsx)("img",{top:!0,width:"100%",src:e.produto.produto__url_imagem,alt:"Sem Imagem"}),Object(k.jsxs)("div",{className:"p-grid",children:[Object(k.jsx)(p.Button,{label:"Alterar",onClick:function(){c(!0)},className:"p-mr-2"}),Object(k.jsx)(p.Button,{label:"Remover",onClick:function(){Object(T.confirmDialog)({message:"Confirma a exclusao do produto?",header:"Confirmacao",icon:"pi pi-exclamation-triangle",acceptLabel:"Sim",rejectLabel:"Nao",accept:function(){return l()}})}}),Object(k.jsx)("div",{className:"p-field p-col-12 p-md-3",children:Object(k.jsx)(E.Dialog,{header:e.produto.produto__produto,maximizable:!0,visible:a,style:{width:"75vw"},onHide:function(){return d()},children:Object(k.jsxs)("div",{className:"p-grid",children:[Object(k.jsx)("div",{className:"p-col",children:Object(k.jsx)("img",{top:!0,width:"100%",src:e.produto.produto__url_imagem,alt:"Sem Imagem"})}),Object(k.jsx)("div",{className:"p-col-fixed",style:{width:"500px"},children:Object(k.jsx)($,{periodoAtual:e.periodoAtual,produto:e.produto,forceUpdate:e.forceUpdate,hideModal:d})})]})})})]})]})})}function $(e){var t=Object(o.useState)(e.produto),n=Object(u.a)(t,1)[0],a=Object(o.useState)(""),c=Object(u.a)(a,2),r=c[0],i=c[1],s=Object(o.useState)({}),d=Object(u.a)(s,2),l=d[0],j=d[1],b=Object(o.useState)(function(e,t){var n=(e=JSON.parse(e)).indexOf(t);n>-1&&e.splice(n,1);(n=e.indexOf("Pre-selecionados"))>-1&&e.splice(n,1);return e}(n.produto__periodos,e.periodoAtual)),h=Object(u.a)(b,1)[0],O=Object(o.useState)(!1),f=Object(u.a)(O,2),v=f[0],x=f[1],_=Object(o.useRef)(null),N=Object(o.useState)(Object(k.jsx)("div",{})),y=Object(u.a)(N,2),C=y[0],I=y[1],T=w("clienteId",null),A=Object(u.a)(T,1)[0],q=w("carrinhoId",null),E=Object(u.a)(q,1)[0],P=w("token",null),z=Object(u.a)(P,2),G=z[0],D=(z[1],S(n.produto__produto,r).dadosPeriodo);Object(o.useEffect)((function(){var e=L(D,n);j(e),v?_.current.show([{severity:"error",summary:"Periodo selecionado nao tem disponivel todas as quantidades digitadas - Verifique as quantidades digitadas",sticky:!0}]):_.current.clear()}),[D,v]),Object(o.useEffect)((function(){if(""!==r){var e=D.map((function(e){return Object(k.jsx)(Q,{dados:e,pedido:l,setPedido:j})}));I(e)}}),[l]);var R=function(e,t){var n=[],o=!1;for(var a in e){t[a]-e[a]<0?(n.push(t[a]),o=!0):n.push(e[a])}return[n,o]},L=function(e,t){var n={},o=JSON.parse(t.qtds),a=!1;for(var c in e){var r=e[c],i=r.cor,s=new Array(t.produto__qtd_tamanhos).fill(0);if(i in o)if(r.liberacao)s=o[i];else{var d=R(o[i],r.qtds),l=Object(u.a)(d,2);s=l[0],l[1]&&(a=!0)}n[i]=s}return x(a),n};return Object(k.jsxs)("div",{children:[Object(k.jsx)(B.Messages,{ref:_}),Object(k.jsx)(F.Dropdown,{id:"dropdown",value:r,options:h,onChange:function(e){return i(e.value)}}),Object(k.jsxs)("div",{className:"p-grid",children:[Object(k.jsx)("div",{className:"p-col",children:"TIPO"}),Object(k.jsx)("div",{className:"p-col",children:"COR"}),JSON.parse(n.produto__tamanhos).map((function(e){return Object(k.jsx)("div",{className:"p-col-1",children:e})}))]}),C,Object(k.jsx)(p.Button,{label:"Alterar",onClick:function(){var t=0;for(var o in l){t+=l[o].reduce((function(e,t){return e+t}),0)}var a={produto:n,periodo:r,qtds:l,qtd_total:t,clienteId:A,carrinhoId:E},c={headers:{Authorization:"Token "+G}};m.a.post(g+"/carrinho/update/"+n.id,a,c).then((function(t){t.data.confirmed?(_.current.show([{severity:"success",summary:t.data.message,sticky:!0}]),e.forceUpdate(),e.hideModal()):_.current.show([{severity:"error",summary:t.data.message,sticky:!0}])})).catch((function(e){console.log(e.message)}))}})]})}function Q(e){var t=function(e,t,n){var o=t.pedido;o[t.dados.cor][n]=e,t.setPedido(o)};return Object(k.jsxs)("div",{className:"p-grid",children:[Object(k.jsx)("div",{className:"p-col",children:e.dados.desc_liberacao}),Object(k.jsx)("div",{className:"p-col",children:e.dados.cor+" - "+e.dados.desc_cor}),function(e){var n=[];if(0===Object.keys(e.pedido).length)return n.map((function(e){return e}));var o=function(){var o=a;e.dados.liberacao?n.push(Object(k.jsx)("div",{className:"p-col-1 p-mt-4",children:Object(k.jsx)(D.InputNumber,{min:0,id:e.dados.cor+o,value:e.pedido[e.dados.cor][o],onValueChange:function(n){return t(n.value,e,o)},mode:"decimal",showButtons:!0,buttonLayout:"vertical",style:{width:"2.5em"},decrementButtonClassName:"p-button-secondary",incrementButtonClassName:"p-button-secondary",incrementButtonIcon:"pi pi-plus",decrementButtonIcon:"pi pi-minus"})})):n.push(Object(k.jsx)("div",{className:"p-col-1 p-mt-4",children:Object(k.jsxs)("span",{className:"p-float-label",children:[Object(k.jsx)(D.InputNumber,{max:e.dados.qtds[o],min:0,id:e.dados.cor+o,value:e.pedido[e.dados.cor][o],onValueChange:function(n){return t(n.value,e,o)},mode:"decimal",showButtons:!0,buttonLayout:"vertical",style:{width:"2.5em"},decrementButtonClassName:"p-button-secondary",incrementButtonClassName:"p-button-secondary",incrementButtonIcon:"pi pi-plus",decrementButtonIcon:"pi pi-minus"}),Object(k.jsx)("label",{htmlFor:e.dados.cor+o,children:e.dados.qtds[o]})]})}))};for(var a in e.dados.qtds)o();return n.map((function(e){return e}))}(e)]})}var K=n(71);function W(){var e=Object(o.useState)(Object(k.jsx)("div",{})),t=Object(u.a)(e,2),n=t[0],a=t[1],c=Object(o.useState)(0),r=Object(u.a)(c,2),i=r[0],s=r[1],d=w("clienteId",null),l=Object(u.a)(d,2),j=l[0],b=l[1],h=w("clienteNome",null),O=Object(u.a)(h,2),f=O[0],v=O[1],x=w("carrinhoId",null),S=Object(u.a)(x,2),_=S[0],N=S[1],y=w("token",null),C=Object(u.a)(y,2),B=C[0],I=(C[1],w("isRep",null)),T=Object(u.a)(I,2),A=T[0],q=(T[1],Object(o.useState)(!1)),P=Object(u.a)(q,2),z=P[0],G=P[1],D=function(e,t){var n=Object(o.useState)([]),a=Object(u.a)(n,2),c=a[0],r=a[1],i=Object(o.useState)(0),s=Object(u.a)(i,2),d=s[0],l=s[1],j=Object(o.useState)(0),b=Object(u.a)(j,2),p=b[0],h=b[1],O=Object(o.useState)(""),f=Object(u.a)(O,2),v=f[0],x=f[1],g=Object(o.useState)(null),S=Object(u.a)(g,2),k=S[0],_=S[1],N=w("carrinhoId",null),y=Object(u.a)(N,2),C=y[0],B=y[1],I=w("token",null),T=Object(u.a)(I,2),A=T[0];return T[1],Object(o.useEffect)((function(){var e={carrinhoId:C,clienteId:t};m()({method:"GET",headers:{Authorization:"Token "+A},url:"https://greencom-api.azurewebsites.net/carrinho",params:e}).then((function(e){e.data.confirmed&&B(e.data.carrinhoId),r(e.data.dados),x(e.data.observacoes),_(e.data.message),l(e.data.valor_total),h(e.data.qtd_total)}))}),[e,C,v,d,p]),{carrinho:c,emptyMessage:k,observacoes:v,valorTotal:d,qtdTotal:p}}(i,j),R=D.carrinho,F=D.emptyMessage,L=D.observacoes,M=D.valorTotal,U=D.qtdTotal,J=Object(o.useState)(""),H=Object(u.a)(J,2),V=H[0],$=H[1],Q=function(){s((function(e){return e+1}))};Object(o.useEffect)((function(){document.title="Greenish B2B | Carrinho"}),[]),Object(o.useEffect)((function(){$(L)}),[L]),Object(o.useEffect)((function(){var e=R,t=Object(k.jsx)("div",{className:"p-col-12 p-md-6 p-lg-3"});e.length>0&&(t=e.map((function(e,t){return Object(k.jsx)("div",{className:"p-col-12 p-md-12 p-lg-12",children:Object(k.jsx)(X,{forceUpdate:Q,periodoAtual:e.periodo,qtd_periodo:e.qtd_periodo,valor_periodo:e.valor_periodo,itens:e.itens},t)})}))),a(t)}),[R,F,_,i]);return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("p",{children:F}),Object(k.jsx)("p",{children:"Cliente: "+f+" | Valor Total: "+M+" | Quantidade Total: "+U}),Object(k.jsx)(p.Button,{label:"Salvar",onClick:function(){return G(!0)},className:"p-mr-2"}),Object(k.jsxs)(E.Dialog,{header:"Observacoes",visible:z,onHide:function(){return G(!1)},children:[Object(k.jsx)("div",{children:Object(k.jsx)(K.InputTextarea,{rows:10,cols:50,value:V,onChange:function(e){return $(e.target.value)}})}),Object(k.jsx)(p.Button,{label:"Salvar",onClick:function(){m()({method:"GET",url:g+"/pedidos/salva/"+_+"/",headers:{Authorization:"Token "+B},params:{observacoes:V}}).then((function(e){e.data.confirmed?(A?(b(null),v(null),N(null)):N(null),window.location.href="/pedidos"):console.log(e.data)}))},className:"p-mr-2"})]}),Object(k.jsx)("div",{className:"p-grid",children:n})]})}function X(e){var t,n=e.itens.slice();return t=n.map((function(t,n){return Object(k.jsx)("div",{className:"p-col-6 p-md-6 p-lg-2",children:Object(k.jsx)(V,{periodoAtual:e.periodoAtual,forceUpdate:e.forceUpdate,produto:t},n)})})),Object(k.jsx)(R.Card,{title:e.periodoAtual+" - "+e.qtd_periodo+" - "+e.valor_periodo,children:Object(k.jsx)("div",{className:"p-grid",children:t})})}function Y(){var e=Object(o.useState)(0),t=Object(u.a)(e,2),n=t[0],a=t[1],c=Object(o.useState)(10),r=Object(u.a)(c,2),i=r[0],s=r[1];return Object(k.jsx)(J.Paginator,{first:n,rows:i,totalRecords:120,rowsPerPageOptions:[10,20,30],onPageChange:function(e){a(e.first),s(e.rows)}})}var Z=n(44),ee=function(e){Object(d.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).state={},o}return Object(s.a)(n,[{key:"verificaLogin",value:function(){var e=JSON.parse(localStorage.getItem("loggedin"));return null==e&&(e=!1),e}},{key:"render",value:function(){var e=this.verificaLogin();return Object(k.jsx)("div",{children:Object(k.jsx)("div",{children:Object(k.jsx)(Z.a,{children:Object(k.jsxs)("div",{children:[Object(k.jsx)("nav",{children:Object(k.jsx)(N,{loggedIn:e})}),Object(k.jsxs)(f.d,{children:[Object(k.jsx)(f.b,{path:"/login",component:I}),Object(k.jsx)(f.b,{path:"/clientes",component:A}),Object(k.jsx)(f.b,{path:"/pedidos",component:P}),Object(k.jsx)(f.b,{path:"/promocoes",component:z}),Object(k.jsx)(f.b,{path:"/conta",component:G}),Object(k.jsx)(f.b,{path:"/carrinho",component:W}),Object(k.jsx)(f.b,{path:"/busca",component:H}),Object(k.jsx)(f.b,{path:"/teste",component:Y}),Object(k.jsx)(f.b,{path:"/:linha/:categoria/:subcategoria",children:e?Object(k.jsx)(H,{}):Object(k.jsx)(f.a,{to:"/login"})}),Object(k.jsx)(f.b,{path:"/:linha/:categoria",children:e?Object(k.jsx)(H,{}):Object(k.jsx)(f.a,{to:"/login"})}),Object(k.jsx)(f.b,{path:"/",component:y})]})]})})})})}}]),n}(a.a.Component),te=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,150)).then((function(t){var n=t.getCLS,o=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),o(e),a(e),c(e),r(e)}))};n(146),n(147),n(148);r.a.render(Object(k.jsx)(a.a.StrictMode,{children:Object(k.jsx)(ee,{})}),document.getElementById("root")),te()},76:function(e,t,n){}},[[149,1,2]]]);
//# sourceMappingURL=main.d50a4ad4.chunk.js.map